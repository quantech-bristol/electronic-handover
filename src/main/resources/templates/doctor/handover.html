<!DOCTYPE HTML>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">

<head th:include="fragments/header :: head (title='Job Handover')">
</head>

<body>
<div th:replace="fragments/header :: header">&nbsp;</div>
<div id="main">
    <div class="main-box">
        <div class="main-box-header">
            Create Handover
        </div>
        <div class="main-box-content">
            <script src="http://code.jquery.com/jquery-1.11.0.min.js"></script>
            <script>
                function showNewPatient() {
                    document.getElementById('newPatient').style.display = 'block';
                    document.getElementById('existingPatient').style.display = 'none';
                }
                function showExistingPatient() {
                    document.getElementById('newPatient').style.display ='none';
                    document.getElementById('existingPatient').style.display = 'block';
                }
                function showPatientDetails() {
                    document.getElementById('patientDetails').style.display = 'block';
                }
            </script>
            <script th:inline="javascript">
                /*<![CDATA[*/
                function populate() {
                    var val = $('#patients').val();
                    console.log(val);
                    for (var i = 0; i < [[${allPatients}]].length; i++) {
                        console.log(i);
                        console.log([[${allPatients}]][i].id);
                        if ([[${allPatients}]][i].id == val) {
                            document.getElementById('existingTitle').value = ([[${allPatients}]][i].title.$name);
                            document.getElementById('existingFirstName').value = [[${allPatients}]][i].firstName;
                            document.getElementById('existingLastName').value = [[${allPatients}]][i].lastName;
                            document.getElementById('existingBirthDate').value = [[${allPatients}]][i].birthDate.dayOfMonth+'/'+[[${allPatients}]][i].birthDate.monthValue+'/'+[[${allPatients}]][i].birthDate.year;
                            document.getElementById('existingHospitalNumber').value = [[${allPatients}]][i].hospitalNumber;
                            document.getElementById('existingNHSNumber').value = [[${allPatients}]][i].NHSNumber;
                        }
                    }
                }
                /*]]>*/
            </script>


            <!--<script>-->
                <!--$('#patients').change(function(){-->
                    <!--var val = $('#patients :selected').val();-->
                    <!--console.log(val);-->
                <!--});-->
            <!--</script>-->

            <!--var patients = [[${allPatients}]]-->
            <!--var patientName = [[${allPatients[0].firstName}]];-->



            <!--// function showPatientDetails() {-->
            <!--//     // var selectedPatient = document.getElementById("patients").value;-->
            <!--//     var firstN = /*[[${existingPatient.firstName}]]*/ null;-->
            <!--//     document.getElementById("firstName").value = firstN;-->
            <!--// }-->

            <!--<script>-->
            <!--function showPatientDetails() {-->
            <!--document.getElementById('patientDetails').style.display = 'block';-->
            <!--document.getElementById("existingFirstName").value = document.getElementById("patients").value;-->
            <!--}-->
            <!--</script>-->

            <!--<select id="patients" th:field="*{existingPatient}" onchange="showPatientDetails();">-->
                <!--<option value="" hidden="true">Select a patient</option>-->
                <!--<option th:each="p : ${allPatients}" th:value="${p}" th:text="${p.firstName}"></option>-->
            <!--</select>-->

            <!--<input type="text" id="firstName" name="firstName" placeholder="first name"/>-->




            <form action="#" th:action="@{/createHandover}" method="post">
                <input type="radio" name="tab" th:field="*{handover.newPatient}" value="TRUE" onclick="showNewPatient();"/>
                Add new patient
                <input type="radio" name="tab" th:field="*{handover.newPatient}" value="FALSE" onclick="showExistingPatient();"/>
                Choose existing patient
                <div id="newPatient" style="display: none">
                    <div class="custom-select">
                        <select id="title" name="title" th:field = "*{newPatient.title}">
                            <option value="" hidden="true">title</option>
                            <option th:each="state : ${T(com.quantech.model.user.Title).values()}" th:value="${state}" th:text="${state}"></option>
                        </select>
                    </div>
                    <input type="text" th:field="*{newPatient.firstName}" id="firstName" name="firstName" placeholder="first name"/>
                    <input type="text" th:field="*{newPatient.lastName}" id="lastName" name="lastName" placeholder="last name"/>
                    <input type="text" th:field="*{newPatient.day}" id="day" name="day" placeholder="dd"/>
                    <input type="text" th:field="*{newPatient.month}" id="month" name="month" placeholder="mm"/>
                    <input type="text" th:field="*{newPatient.year}" id="year" name="year" placeholder="yyyy"/>
                    <input type="number" th:field="*{newPatient.hospitalNumber}" id="hospitalNumber" name="hospitalNumber" placeholder="hospital number"/>
                    <input type="number" th:field="*{newPatient.NHSNumber}" id="NHSNumber" name="NHSNumber" placeholder="NHS number"/>
                    <button type="submit" class="orange-button">Submit</button>
                </div>
                <div id="existingPatient" style="display: none">
                    <select id="patients" name="patients" onchange="showPatientDetails(); populate();">
                        <option value="" hidden="true">Choose patient</option>
                        <option th:each="patient : ${allPatients}" th:value="${patient.id}" th:text="${patient.title}+' '+${patient.firstName}+' '+${patient.lastName}"></option>
                    </select>
                    <div id="patientDetails" style="display: none;">
                        <div>
                            <input type="text" id="existingTitle" name="existingTitle" placeholder="title"/>
                            <input type="text" id="existingFirstName" name="existingFirstName" placeholder="first name"/>
                            <input type="text" id="existingLastName" name="existingLastName" placeholder="last name"/>
                        </div>
                        <div>
                            <input type="text" id="existingBirthDate" name="existingBirthDate" placeholder="date of birth" disabled="true"/>
                            <input type="number" id="existingHospitalNumber" name="existingHospitalNumber" placeholder="hospital number" disabled="true"/>
                            <input type="number" id="existingNHSNumber" name="existingNHSNumber" placeholder="NHS numbers" disabled="true"/>
                        </div>
                    </div>

                </div>
                <!--</div>-->
                <!--<div> &lt;!&ndash; Add or choose/edit job context &ndash;&gt;-->
                    <!--&lt;!&ndash;Clinical information&ndash;&gt;-->
                <!--</div>-->
                <!--<div> &lt;!&ndash; Add job &ndash;&gt;-->
                    <!--&lt;!&ndash;Job details<br/>&ndash;&gt;-->
                    <!--&lt;!&ndash;Job notes<br/>&ndash;&gt;-->
                    <!--&lt;!&ndash;Choose receiving doctor&ndash;&gt;-->
                    <!--&lt;!&ndash;<select id="recipientDoctor" class="form-control" th:field="${handover.recipient}">&ndash;&gt;-->
                    <!--&lt;!&ndash;<select id="recipientDoctor" class="form-control">&ndash;&gt;-->
                        <!--&lt;!&ndash;<option th:each="doctor: ${doctors}" th:if="${currentDr.id} != ${doctor.id}" th:value="${doctor.id}"&ndash;&gt;-->
                        <!--&lt;!&ndash;th:text="${doctor.firstName}+' '+${doctor.lastName}"></option>&ndash;&gt;-->
                    <!--&lt;!&ndash;</select>&ndash;&gt;-->
                <!--</div>-->

            </form>
        </div>
    </div>
</div>
</body>
</html>